---
import Layout from "@/layouts/Layout.astro";
---

<Layout title="Sorteo de Grupos" mainClassname="px-6 sm:px-10 pt-24 pb-32">
  <section class="max-w-6xl mx-auto">

    <!-- TÃTULO EPICO -->
    <div class="text-center mb-8">
      <p class="uppercase tracking-[0.4em] text-4xl md:text-6xl font-anton font-bold mb-2 text-white drop-shadow-lg">
  TORNEO ROCKET LEAGUE
</p>

      <h1 class="font-anton text-4xl md:text-5xl mt-2 bg-gradient-to-r from-amber-400 to-yellow-300 bg-clip-text text-transparent">
        Sorteo de Grupos
      </h1>
    </div>

    <!-- LISTA DE EQUIPOS -->
    <div class="mb-6">
      <label class="text-sm text-white/70 mb-2 block">
        Lista de equipos (uno por lÃ­nea)
      </label>

      <textarea
        id="teamList"
        class="w-full h-36 rounded-xl bg-white/5 border border-white/10 p-4 focus:outline-none focus:ring-2 focus:ring-amber-400"
      >Deportivo MTM
VasACorrer
Los sin pelo
Desertores CÃºbicos
Team FZBR
La 141
Therian & Furious
Fuerza Torales
MATE & TACO
Los changos
TÃ³xicos a la pala
PUSKAS
Anti Therian
YEN
CAP1891
Equipo 16</textarea>
    </div>

    <!-- CONTROLES DE SORTEO -->
    <div class="flex flex-wrap gap-3 mb-8">
      <select
        id="groupSelect"
        class="bg-white/5 border border-white/10 rounded-lg px-4 py-2"
      >
        <option value="A">Grupo A</option>
        <option value="B">Grupo B</option>
        <option value="C">Grupo C</option>
        <option value="D">Grupo D</option>
      </select>

      <button
        onclick="drawTeam()"
        class="px-5 py-2 rounded-lg font-semibold bg-gradient-to-r from-amber-400 to-yellow-300 text-black hover:scale-105 transition"
      >
        ðŸŽ² Sortear equipo
      </button>

      <button
        onclick="resetDraw()"
        class="px-5 py-2 rounded-lg font-semibold bg-white/10 hover:bg-white/20 transition"
      >
        ðŸ”„ Reiniciar
      </button>
    </div>

    <!-- RESULTADO -->
    <div id="result" class="text-center text-lg font-semibold text-green-400 mb-6"></div>

    <!-- GRUPOS -->
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-5">
      {["A","B","C","D"].map(group => (
        <div class="rounded-2xl border border-white/10 bg-white/5 p-8 shadow-lg">
          <h2 class="text-center font-bold text-2xl md:text-3xl text-amber-300 mb-4">
            Grupo {group}
          </h2>
          <ul id={`group${group}`} class="space-y-2"></ul>
        </div>
      ))}
    </div>

    <!-- 16 IMÃGENES DE EQUIPOS -->
    <div class="mt-8 max-w-6xl mx-auto grid grid-cols-4 sm:grid-cols-8 lg:grid-cols-16 gap-4">
      {Array.from({length:16}).map((_, i) => (
        <img
          src={`/images/team-logos/team${i+1}.webp`}
          alt={`Equipo ${i+1}`}
          class="w-full h-auto rounded-lg border border-white/10 hover:scale-110 hover:drop-shadow-xl transition-transform duration-300"
        />
      ))}
    </div>

  </section>

  <!-- OVERLAY -->
  <div
    id="drawOverlay"
    class="fixed inset-0 bg-black/80 backdrop-blur flex items-center justify-center opacity-0 pointer-events-none transition"
    style="display:none"
  >
    <div
      id="drawText"
      class="text-4xl md:text-6xl font-anton px-8 py-4 rounded-xl bg-gradient-to-r from-amber-400 to-yellow-300 text-black"
    >
      SORTEANDO...
    </div>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      let remainingTeams = [];

      function loadTeamsIfNeeded() {
        if (remainingTeams.length === 0) {
          remainingTeams = document.getElementById("teamList").value
            .split("\n")
            .map(t => t.trim())
            .filter(t => t !== "");
        }
      }

      window.drawTeam = function () {
        loadTeamsIfNeeded();

        if (remainingTeams.length === 0) {
          alert("No quedan equipos por sortear");
          return;
        }

        const overlay = document.getElementById("drawOverlay");
        const text = document.getElementById("drawText");
        const group = document.getElementById("groupSelect").value;

        const randomIndex = Math.floor(Math.random() * remainingTeams.length);
        const selectedTeam = remainingTeams[randomIndex];

        overlay.style.display = "flex";
        overlay.classList.remove("opacity-0","pointer-events-none");
        overlay.classList.add("opacity-100");

        text.textContent = "SORTEANDO...";
        text.classList.add("pulsing");
        text.classList.remove("reveal");

        setTimeout(() => {
          text.textContent = selectedTeam;
          text.classList.remove("pulsing");
          text.classList.add("reveal");
        }, 1500);

        setTimeout(() => {
          remainingTeams.splice(randomIndex, 1);

          const li = document.createElement("li");
          li.textContent = selectedTeam;
          li.className = "bg-white/5 border border-white/10 rounded-lg py-2 text-lg font-semibold text-center drop";

          document.getElementById("group" + group).appendChild(li);
          document.getElementById("result").textContent =
            "Equipo sorteado: " + selectedTeam;

          overlay.classList.add("opacity-0","pointer-events-none");
          setTimeout(() => {
            overlay.style.display = "none";
            text.textContent = "";
            text.classList.remove("reveal","pulsing");
          }, 300);
        }, 3000);
      };

      window.resetDraw = function () {
        remainingTeams = [];
        ["A","B","C","D"].forEach(g => {
          document.getElementById("group" + g).innerHTML = "";
        });
        document.getElementById("result").textContent = "";
      };
    });
  </script>

  <style>
    @keyframes dropIn {
      0% { transform: translateY(-40px); opacity:0; }
      100% { transform: translateY(0); opacity:1; }
    }

    .drop {
      animation: dropIn .5s ease;
    }

    .pulsing {
      animation: pulse 1s infinite alternate;
    }

    @keyframes pulse {
      from { transform: scale(1); }
      to { transform: scale(1.08); }
    }

    .reveal {
      animation: reveal .35s ease;
    }

    @keyframes reveal {
      from { transform: scale(.85); opacity:0 }
      to { transform: scale(1); opacity:1 }
    }
  </style>

</Layout>
